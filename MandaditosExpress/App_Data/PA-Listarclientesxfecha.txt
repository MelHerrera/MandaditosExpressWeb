-- =============================================
-- Author: <Author,Herminia>
-- Create date: <Create 23/09/2021>
-- Description: <filtrar por fechas la lista de clientes>
-- =============================================
CREATE PROCEDURE FltListCltsFech
-- Add the parameters for the stored procedure here
@Desde datetime,
@Hasta datetime
AS

BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;

    -- Insert statements for procedure here
select p.PrimerNombre + ' ' +p.SegundoNombre+ ' ' + p.PrimerApellido + ' ' +p.SegundoApellido as [Nombres], p.CorreoElectronico  as [Correo], p.Telefono, p.FechaIngreso as [FechaDeIngreso], c.NombreDeLaEmpresa as [Empresa]
from Personas as p
cross join Clientes as c
where p.FechaIngreso between @Desde and @Hasta and p.Id in (select c.Id from dbo.Clientes as c)
group by  p.PrimerNombre, p.SegundoNombre, p.PrimerApellido, p.SegundoApellido, p.CorreoElectronico, p.Telefono, p.FechaIngreso, c.NombreDeLaEmpresa
END